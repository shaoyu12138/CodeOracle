# 周易创新占卜工具

这是一个基于 Python 的命令行占卜工具，它结合了《周易》的卦爻体系和《焦氏易林》的变占解释，提供一种独特的占卜体验。脚本根据用户输入生成本卦，并推演出变卦、互卦、错卦、综卦，最后将详细的卦象信息及焦氏易林辞保存到文本文件中。

*简单介绍周易占卜：每一个八卦对应一个3位二进制数，两个八卦两两组合为6位二进制的64卦。卦的每一个位（古称爻）可以变动，得到变卦。结合本卦，动爻和变卦可以对某一件事情进行具体的占断，本卦表示当前态势，动爻表示具体状态，变卦表示预测结果。本卦和变卦组合有64乘以64=4096种《焦氏易林》辞，可以作为更深层次的解卦信息。更多的例如卦名属性，大象小象，杂卦彖传会在输出中显示作为辅助信息使用。*

## 目录设置

**目录结构**: 你的项目目录应如下所示：
```
CodeOracle/
├── assets/
│   ├── 64_Gua_Data_4096.json
│   ├── 64_Gua_Data.json
│   └── prompt.txt
├── divination_wrapper.py
├── gua_lookup.py
├── README.md
└── test.ipynb
```

**注意事项**：`64_Gua_Data.json`和`64_Gua_Data_4096.json`中的内容是作者手动整理而成，敬请有缘之士使用，以便广播易道。前者包含周易的卦名属性，卦辞爻辞，大象小象，杂卦彖传，内容完备而校对正确。后者取自[中国哲学书电子化计划 - 简体字版](https://ctext.org/jiaoshi-yilin/zhs)，有着更丰富的易于理解的信息。注意，64卦和8卦的卦序与传统的周公孔子卦序有所不同，实际使用了符合二进制表示的卦序排列，详情请阅读[卦序说明](assets/卦序研究/README.md)

## 如何使用

1.  打开你的终端或命令行工具。
2.  使用 `cd` 命令切换到包含 `test.ipynb` 脚本所在的目录。
3.  运行`test.ipynb`脚本对应的单元格：
4.  根据命令行提示，依次输入：
    *   你的性别（0代表男，1代表女）
    *   你所问问题的背景信息
    *   你具体想问的问题
5.  脚本将执行占卜过程，并在屏幕上打印简要提示信息。
6.  占卜完成后，脚本会提示结果已保存到文件。
7.  打开文件，全文复制并发送给具有推理功能的LLM模型，获取丰富而有针对性的回答。


## 输出说明

脚本运行结束后，会在当前目录下生成一个名为 `question_YYYY_MM_DD_HH_MM_SS.txt` 的文本文件（其中 `YYYY_MM_DD_HH_MM_SS` 是占卜执行的时间戳）。该文件包含了本次占卜的完整记录，内容结构大致如下：

*   开头的解卦师角色和解卦须知。
*   用户输入的问题背景和具体问题。
*   **本卦**信息：卦名、卦象、上下卦、杂卦、彖传、卦辞、大象、动爻爻位、爻辞、小象。
*   **变卦**信息：卦名、卦象、上下卦、杂卦、彖传、卦辞、大象。
*   **焦氏易林解**：基于本卦和变卦组合的《焦氏易林》断辞。
*   **互卦**信息：卦名、卦象、上下卦、杂卦、彖传、卦辞、大象。
*   **错卦**信息：卦名、卦象、上下卦、杂卦、彖传、卦辞、大象。
*   **综卦**信息：卦名、卦象、上下卦、杂卦、彖传、卦辞、大象。
*   （如果 `simplified=False`，还会包含二进制表示和计算过程；print_extra=True会使得每一个卦都含有自己的动爻使得信息更加丰富）

请打开此文件查看详细的占卜结果和解读指引。

## 占卜方法论简述

本脚本采用一种特定的7位二进制方法来表示和推演卦象：

1.  **本卦**: 第7位（最高位）表示性别（0男，1女），后6位随机生成。若为女性（1），则7位全部取反进行“规范化”。
2.  **变卦**: 根据本卦动爻数 `k` 生成一个掩码，此掩码与一个7位随机数进行`与`运算，得到实际变爻掩码。此实际掩码与本卦二进制进行`或`运算，结果再进行“规范化”。
3.  **互卦**: 取本卦（规范化后）的第5、4、3爻组成上卦，第4、3、2爻组成下卦，高位补0后规范化。
4.  **错卦**: 取本卦（规范化后）除符号位外的6爻，逐位取反，高位补0后规范化。
5.  **综卦**: 取本卦（规范化后）除符号位外的6爻，上下逆序排列，高位补0后规范化。

*注：此方法旨在兼容《焦氏易林》的 4096 种变化和《周易》，具体细节请参考代码内注释。*

## 免责声明

本工具提供的占卜结果源于特定的算法和数据，仅供参考、研究和娱乐。请勿将其作为决策的唯一依据。
